apiVersion: helm.cattle.io/v1
kind: HelmChart
metadata:
  name: kube-prometheus-stack
  namespace: kube-system
spec:
  repo: https://prometheus-community.github.io/helm-charts
  chart: kube-prometheus-stack
  version: 61.3.1
  targetNamespace: monitoring
  valuesContent: |
    grafana:
      adminPassword: "admin"
      service:
        type: ClusterIP

    prometheus:
      prometheusSpec:
        additionalScrapeConfigs:
          - job_name: 'external-nodes'
            static_configs:
              - targets: [] # Add your external node IPs here

    alertmanager:
      alertmanagerSpec:
        useExistingSecret: true
        configSecret: "alertmanager-telegram-config"

    nodeExporter:
      enabled: true
    kubeStateMetrics:
      enabled: true
    grafana:
      enabled: true
